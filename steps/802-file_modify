#!/usr/bin/perl -w
# Modify files according to the file_modify section
# vim:tw=100 sw=2 expandtab ft=perl
#
# Example:
#
# file_modify => [
#   '/etc/updatedb.conf' => [
#     's/^DAILY_UPDATE=no/DAILY_UPDATE=yes/',  # Run this regex across every line in the file
#   ],
# ],

validate_config {
  file_modify => {
    type => "hash_list",
    key => {
      type => "path",
    },
    value => {
      help => "List of regex style replaces to run on the file",
      type => "list",
      items => { type => "string" },
    },
  },
};

my @list = flatten_list(c("$hostname/file_modify"));
file_modify(-file => shift @list, -modify => shift @list) while @list;
